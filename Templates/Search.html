<html translate="no">
<link rel="stylesheet" href="{{url_for('static', filename='css/style.css')}}">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin="" />
<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>



<title>Search Team view</title>
</head>
<header id="header">
<h2 class="right">Search Team View<h2>
<div class="navbar">
  <a id="pathButton" href=# onclick="path()" style="display:hidden;"><optionL>Path</optionL></a>
  <a id="updateButton" href=# onclick="update()" style="display:hidden;"><optionL>Update</optionL></a>	
  <div class="dropdown" style="float: right;">
    <button class="dropbtn"> Settings
      <i class="fa fa-caret-down"></i>
    </button>
    <div class="dropdown-content" style="position:absolute; right:0;">
      <a href=#>Testing</a>
      
    </div>
  </div>	
</div>
</header>

<body>
<div id="form">
	<form class="form" style="top:50%;">Please enter your connection key:<br><br>
		<input type="text" id="key" name="key" placeholder="Connection Key" class = "box"><br><br>
		<input class="buttonstyle" type=button id = "Submit" value = "Submit">
	</form>
</div>
<div id="path" style="display:none">
<input type=number name="team" id="team" min="1" onchange="changeTeam()" value="1" style="margin:auto">
<table id="pathing" class="changeTable">
    <thead><tr><td>trail</td><td>Searched</td></tr></thead>
    <tbody id="body"></tbody>
  </table>
</div>
<div id="update" style="display:none">
<form class="form">
	Update
</form>
</div>
  
<script>
var pathDict;
 $(function() {
		$("#Submit").click(function () {
				var key = document.getElementById("key").value
				$.ajax({
				method: "POST",
				url: "{{ url_for('connectSearch')}}",
				data: {"key":key},
				})
				.done(function(msg){
					if(msg=="False"){
						alert("invalid connection key")
					}
					else{
						len=Object.keys(msg).length;
						for(let i=0;i<msg[0].length;i++){
							document.getElementById("body").innerHTML+="<tr><td>"+msg[0][i]+"</td></tr>";
						}
						pathDict=msg
						document.getElementById("form").style.display="none";
						document.getElementById("path").style.display="block";
						document.getElementById("updateButton").style.display="block";
						document.getElementById("pathButton").style.display="block";
						document.getElementById("team").max=len;
					
					}
				})
			})
    });   
function update(){
	document.getElementById("path").style.display="none";
	document.getElementById("update").style.display="block";
	return false;
}
function path(){
	document.getElementById("path").style.display="block";
	document.getElementById("update").style.display="none";
	return false;
}
	
function changeTeam(){
	document.getElementById("body").innerHTML="";
	index=(document.getElementById("team").value)-1;
	for(let i=0;i<pathDict[index].length;i++){
		document.getElementById("body").innerHTML+="<tr><td>"+pathDict[index][i]+"</td></tr>";
	}

}
</script>
</body>
</html>
